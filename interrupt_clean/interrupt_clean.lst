gavrasm Gerd's AVR assembler version 5.1 (C)2021 by DG4FAC
----------------------------------------------------------

Path:        /home/anonimo/Desktop/sis_embarcados/avr-projects/interrupt_clean/
Source file: interrupt_clean.asm
Hex file:    interrupt_clean.hex
Eeprom file: interrupt_clean.eep
Compiled:    28.07.2022, 15:36:28
Pass:        2

     1: .MACRO CFG_STACK
     2:      LDI R16,HIGH(RAMEND) // R16 = RAMEND_HIGH
     3:      OUT SPH,R16 // SPH = R16
     4:      LDI R16,LOW(RAMEND) // ...
     5:      OUT SPL,R16
     6: .ENDMACRO
     7: 
     8: .MACRO CFG_PORT
     9:      LDI R16,(1<<PD2)
    10:      OUT DDRD,R16
    11:      LDI R17,(1<<PD2)
    12:      OUT PORTD,R17
    13: .ENDMACRO
    14: 
    15: .MACRO CFG_HANDLER
    16: LDI R16,0x00
    17: ;     LDI R16,(1<<ISC01)
    18:      sts EICRA,R16
    19:      LDI R17,(1<<INT0)
    20:      out EIMSK,R17
    21: .ENDMACRO
    22: 
    23: .MACRO CFG_LED
    24:      LDI R16,(1<<PB5)
    25:      OUT DDRB,R16
    26:      LDI R18,(1<<PB5)
    27:      OUT PORTB,R18
    28: .ENDMACRO
    29: 
    30: .MACRO HANDLER_MAIN
    31:       CPI R18,0x20
    32:       BREQ TURN_OFF   ; ta ligado vai pra desligar
    33:       RJMP TURN_ON    ; ta desligado vai pra ligar
    34: .ENDMACRO
    35: 
    36: // diz o microcontrolador especifico p/ o compilador
    37: .device ATMega328p
    38: // inicio da memoria de código
    39: .org 0x0000
    40: // pula pro inicio do código
    41: 000000   C022  rjmp   INIT
    42: .org 0x0002
    43: 000002   C01E  rjmp HANDLER
    44: 
    45: ALTERNA_INIT:
    46: 
    47: 000003   E200  LDI R16,0x20
    48: 000004   E210  LDI R17,0x20
    49: 000005   B904  OUT DDRB,R16
    50: 000006   C014  rjmp ALTERNA
    51: 
    52: SUBTRAI:
    53: 000007   952A  DEC R18            ;subração
    54: 000008   3020  CPI R18,0x00       ; comparar
    55: 000009   F089  BREQ ALTERNA       ; se ta zero vai pro alterna
    56: 00000A   EF3F  LDI R19,0xFF       ;reinicializa o registrador r19
    57: 00000B   C000  RJMP SUBTRAI_2     ;se nao ta zerado vai pro subtrai 2
    58: 
    59: SUBTRAI_2:
    60: 00000C   953A  DEC R19
    61: 00000D   3030  CPI R19,0x00
    62: 00000E   F3C1  BREQ SUBTRAI
    63: 00000F   EF4F  LDI R20,0xFF
    64: 000010   C000  RJMP SUBTRAI_3
    65: 
    66: 
    67: SUBTRAI_3:
    68: 000011   954A  DEC R20
    69: 000012   3040  CPI R20,0x00
    70: 000013   F3C1  BREQ SUBTRAI_2
    71: 000014   CFFC  RJMP SUBTRAI_3
    72: 
    73: TURN_ON:
    74: 000015   E210  LDI R17, 0x20        ; liga led
    75: 000016   B915  OUT PORTB,R17
    76: 000017   CFEF  rjmp SUBTRAI
    77: 
    78: 
    79: TURN_OFF:                  ; desliga led
    80: 000018   E010  LDI R17, 0x00
    81: 000019   B915  OUT PORTB,R17
    82: 00001A   CFEC  rjmp SUBTRAI
    83: 
    84: 
    85: ALTERNA:
    86: 00001B   EF2F  LDI R18,0xFF    ;inicializando o registrador
    87: 00001C   EF3F  LDI R19,0xFF    ;inicializando o registrador
    88: 00001D   EF4F  LDI R20,0xFF    ;inicializando o registrador
    89: 00001E   3210  CPI R17,0x20
    90: 00001F   F3C1  BREQ TURN_OFF   ; ta ligado vai pra desligar
    91: 000020   CFF4  RJMP TURN_ON    ; ta desligado vai pra ligar
    92: 
    93: 000021   C000  RJMP HANDLER_END
    94: 
    95: 
    96: HANDLER_END:
    97: 000022   9518  RETI
    98: 
    99: 
   100: INIT:
   101: 
   102:     CFG_STACK
   102: 000023   E008  LDI R16,HIGH(RAMEND) // R16 = RAMEND_HIGH
   102: 000024   BF0E  OUT SPH,R16 // SPH = R16
   102: 000025   EF0F  LDI R16,LOW(RAMEND) // ...
   102: 000026   BF0D  OUT SPL,R16
   103:       CFG_PORT
   103: 000027   E004  LDI R16,(1<<PD2)
   103: 000028   B90A  OUT DDRD,R16
   103: 000029   E014  LDI R17,(1<<PD2)
   103: 00002A   B91B  OUT PORTD,R17
   104:   CFG_LED
   104: 00002B   E200  LDI R16,(1<<PB5)
   104: 00002C   B904  OUT DDRB,R16
   104: 00002D   E220  LDI R18,(1<<PB5)
   104: 00002E   B925  OUT PORTB,R18
   105:  CFG_HANDLER
   105: 00002F   E000  LDI R16,0x00
   105: ;     LDI R16,(1<<ISC01)
   105: 000030   9300  sts EICRA,R16
        000031   0069
   105: 000032   E011  LDI R17,(1<<INT0)
   105: 000033   BB1D  out EIMSK,R17
   106: 000034   9478  SEI
   107: 000035   C000  RJMP LOOP
   108: 
   109: 000036   CFFF  RJMP LOOP
   110: 
   111: 
   112: 
   113: 
   114: 
   115: 
   116: 
   117: 

List of symbols:
Type nDef nUsed             Decimalval           Hexval Name
  T     1     1                    171               AB ATMEGA328P
  L     1     0                      3               03 ALTERNA_INIT
  L     1     6                      7               07 SUBTRAI
  L     1     4                     12               0C SUBTRAI_2
  L     1     4                     17               11 SUBTRAI_3
  L     1     2                     21               15 TURN_ON
  L     1     2                     24               18 TURN_OFF
  L     1     4                     27               1B ALTERNA
  L     1     2                     33               21 HANDLER
  L     1     2                     34               22 HANDLER_END
  L     1     2                     35               23 INIT
  L     1     4                     54               36 LOOP
  C     1     0                     22               16 NOW_Y
  C     1     0                      7               07 NOW_M
  C     1     0                     28               1C NOW_D
  C     1     0                  44770             AEE2 NOW_I

List of macros:
nLines nUsed nParams Name
     4     1       0 CFG_STACK
     4     1       0 CFG_PORT
     5     1       0 CFG_HANDLER
     4     1       0 CFG_LED
     3     0       0 HANDLER_MAIN

Program             :       54 words.
Constants           :        0 words.
Total program memory:       54 words.
Eeprom space        :        0 bytes.
Data segment        :        0 bytes.
Compilation completed, no errors.
Compilation ended 28.07.2022, 15:36:28
